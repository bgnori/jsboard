<h1 class="clause">5. Event Message Definitions</h1>
<p>
    Application events are published in event messages sent from a Bayeux client to
    a Bayeux server and are delivered in event messages sent from a Bayeux server to a Bayeux client.
</p>

<p>
    Application eventは、event messageを用いてクライアントからサーバに向かってに発行され、また、同様にサーバからクライアントに配送される。
</p>


<h2 class="clause">5.1. 発行(Publish)</h2>

<h3 class="clause">5.1.1. 発行要求(Publish Request)</h3>

<p>
    A Bayeux client can publish events on a channel by sending event messages.
    An event message MAY be sent in new HTTP request or it MAY be sent in the same HTTP request as
    any message other than a handshake meta message.
</p>
<p>
  クライアントはevent messageをチャンネルを通じて送ることでeventを発行することができる。
  イベントメッセージはあらたなHTTP requestを用いて送ることもできるし、ハンドシェークメタメッセージとして送ることもできる。
</p>

<p>
    A publish message MAY be sent from an unconnected client (that has not performed handshaking and thus does
    not have a client ID). It is OPTIONAL for a server to accept unconnected publish requests and they
    should apply server specific authentication and authorization before doing so.
    発行メッセージは非接続のクライアント(つまりそのクライアントはまだハンドシェークを行っていないためにクライアントIDを持っていない)
    からも送ることができる。サーバはそのような発行要求を受けつけるのか、はたまた認証をその前に行うのかはオプションである。

</p>

<p>
    A publish event message MUST contain the message fields:
</p>
<p>
  発行イベントメッセージは、次のメッセージフィールドを含んでいなければならない。
</p>
<dl>
    <dt>channel</dt>
    <dt>data</dt>
    <dd>The message as an arbitrary JSON encoded object</dd>
</dl>

<p>
    A publish event message MAY contain the message fields:
</p>
<p>
  発行イベントメッセージは、次のメッセージフィールドを含んでいてもよい。
</p>
<dl>
    <dt>clientId</dt>
    <dd>The client ID returned in the handshake response</dd>
    <dt>id</dt>
    <dd>A unique ID for the message generated by the client</dd>
    <dt>ext</dt>
</dl>
<p>An example event message is:</p>
<p>イベントメッセージの例</p>
<pre class="example">
[
  {
     "channel": "/some/channel",
     "clientId": "Un1q31d3nt1f13r",
     "data": "some application string or JSON encoded object",
     "id": "some unique message id"
  }
]
</pre>


<h3 class="clause">5.1.2. 発行応答(Publish Response)</h3>

<p>
    A Bayeux server MAY respond to a publish event message with a publish event acknowlegement.
</p>
<p>
    サーバは発行イベントメッセージに対して、発行イベント了解を返してもよい。
</p>
<p>
    A publish event message MUST contain the message fields:
</p>
<p>
  発行イベントメッセージは次のメッセージフィールドを含まなければならない。
  訳注: 発行レスポンス了解のことか？
</p>
<dl>
    <dt>channel</dt>
    <dt>successful</dt>
    <dd>boolean indicating the success or otherwise of the publish</dd>
</dl>
<p>A publish event response MAY contain the message fields:</p>
<p>
  発行イベントメッセージは次のメッセージフィールドを含んでもよい。
</p>
<dl>
    <dt>id</dt>
    <dt>error</dt>
    <dt>ext</dt>
</dl>
<p>An example event reponse message is:</p>
<p> 例: </p>
<pre class="example">
[
  {
     "channel": "/some/channel",
     "successful": true,
     "id": "some unique message id"
  }
]
</pre>

<h2 class="clause">5.2. イベントメッセージの配送 Delivery of event messages</h2>

<p>
    Event messages MUST be delivered to clients if the client is subscribed to the channel of the event message.
    Event messages MAY be sent to the client in the same HTTP response as any other message other than a meta handshake
    response.<br/>
    If a Bayeux server has multiple HTTP requests from the same client, the server SHOULD deliver all available messages
    in the HTTP response that will be sent immediately in preference to waking a waiting connect meta message request.<br/>
    Event message delivery MAY not acknowledged by the client.
</p>

<p>
  イベントメッセージは、そのイベントメッセージのチャネルを購読しているクライアントに配送されなければならない。
  イベントメッセージは、メタハンドシェイクレスポンスと同じHTTP respnseで配送されてもよい。
  
  サーバが複数のHTTP requestを同一クライアントから受け取った場合、サーバはすべての利用可能なメッセージを1つのHTTP
  responseで返さなければならない。メタメッセージ要求

    If a Bayeux server has multiple HTTP requests from the same client, the server SHOULD deliver all available messages
    in the HTTP response that will be sent immediately in preference to waking a waiting connect meta message request.<br/>
訳注：理解不能。

    Event message delivery MAY not acknowledged by the client.
イベントメッセージ配送に関してクライアントから了解が返るとは限らない。

</p>

<p>
    A deliver event message MUST contain the message fields:
</p>
<p>
    配送イベントメッセージは次のメッセージフィールドを含まなければならない。
</p>
<dl>
    <dt>channel</dt>
    <dt>data</dt>
    <dd>The message as an arbitrary JSON encoded object</dd>
</dl>
<p>A deliver event response MAY contain the message fields:</p>
<p>
    配送イベントメッセージは次のメッセージフィールドを含んでもよい。
</p>
<dl>
    <dt>id</dt>
    <dd>Unique message ID from the publisher</dd>
    <dt>clientId</dt>
    <dd>The client ID returned in the handshake response</dd>
    <dt>ext</dt>
    <dt>advice</dt>
</dl>
<p>An example event deliver message is:</p>
<p> 例:</p>
<pre class="example">
[
  {
     "channel": "/some/channel",
     "data": "some application string or JSON encoded object",
     "id": "some unique message id"
  }
]
</pre>

